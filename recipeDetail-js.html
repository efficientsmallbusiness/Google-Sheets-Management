/******** BATCH SPECIFIC VARIABLES *****/

 
 
  /*------------------------------------------------------------------------------------*/
  /*********************************** EVENT HANDLERS ***********************************/
  /*------------------------------------------------------------------------------------*/
  


$(function(){
  var id = memory_.loadedRecordId;
    if (id) {
      console.log(`The record "${id}" will be loaded`);
      getRecipeData(id);
    }
    
    
   refreshSelectElements();
   createNewRowEventTrigger();
   createOnChangeTrigger();
   
});


  /*-------------------------------------------------------------------------------------*/
  /***********************************    FUNCTIONS    ***********************************/
  /*-------------------------------------------------------------------------------------*/


// Get recipe data from server
function getRecipeData(recipeId){
  google.script.run.withSuccessHandler(processPageData).getPageData(memory_.user.company,'recipe',recipeId);
}





///**
// * Clears the batch page
// */
// function loadNewRecipe(){
// // clear all elements
//  clearInputElements();
//  // Get new recipe id from server
//   getNewRecipeId();
//   // Load tables with no data
//   loadTables({isNewRecipe:true});
//   // Display success message
//   toast_('New batch created!','success');
// }
// 
// 
//
// 
// /**
// * Get the next available batch id from the server
// *
// * return {callback function} updateRecipeSelector
// */
// function getNewRecipeId(){
//   google.script.run.withSuccessHandler(updateRecipeSelector).getRecipeId();
// }
//
//
//
//function getRecipeList() {
//   
//   google.script.run.withSuccessHandler(fillrecipeSelector).getRecipeList();
//}
//
//
//
//// Fill options list for recipe select element
//function fillrecipeSelector(optionsArray){
//  var recipeSelector = convertOptionsArray(optionsArray,memory_.activePage);
//    
//  // Append options to recipe select element
//  fillHtmlSelect('#recipeSelector',recipeSelector);
//  
//  // According to documentation, this is supposed to enable the devices native select menu
//  // It doesn't seem to work on my iPhone, but I'm going to keep it anyway.
//  if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
//    $('.selectpicker').selectpicker('mobile');
//  }
//
//  
//  
//  // Hide pre-loader
//  $("#indexLoader").hide();
//}
//
//
///**
//* Create change event trigger for recipe select
//* This triggers when the user makes a selection from the recipe drop-down menu
//* that is located a the top of the recipe page
//*/
//function createRecipeSelectEvent() {
//
//    $('#recipeSelector').change(function() {
//      
//     // Get batch id from selection
//      var recipeId = $('option:selected', this).attr('data-id');
//      
//      // Put the current recipe id into temporary storage
//      memory_.currentRecipeId = recipeId;
//      
//      
//      // If a selection is new recipe, then clear all the fields and load blank tables
//      if (recipeId === 'newRecipe') {
//        loadNewRecipe();
//        return;
//      }
//      
//         // show loader
//      $(".fileLoadingSpinner").show();
//      
//      // Hide batch information
//      $(".loadTable").hide();
//      
//      // Fetch data from server
//      getRecipeData(recipeId);
//      
//      
//    });
//
//}