
 
  /*------------------------------------------------------------------------------------*/
  /*********************************** EVENT HANDLERS ***********************************/
  /*------------------------------------------------------------------------------------*/
  
  
  

 // Page load
 $(function() {
    
    var id = memory_.loadedRecordId;
    if (id) {
      console.log(`The record "${id}" will be loaded`);
      getBatchData(id);
    }
      
      
      $('#showStarterDetails').click(function(){
          if($(this).is(":checked")){
            $('#starterDetails').show();
          } else {
            $('#starterDetails').hide();
          }
       })
       
    refreshSelectElements(); 
    createNewRowEventTrigger();
    createOnChangeTrigger();
     
  })
  
  
  /*-------------------------------------------------------------------------------------*/
  /***********************************    FUNCTIONS    ***********************************/
  /*-------------------------------------------------------------------------------------*/



// Get batch data from server
function getBatchData(recipeId){
  google.script.run.withSuccessHandler(processPageData).getPageData(memory_.user.company,'batch',recipeId);
}
  
  
  
  
function getBatchList(){

  var batchList = memory_.lists.batchList;
  
  // If the user has not refreshed the page
  // The batch list should still be in the temporary data variable
   if (batchList) {
     fillBatchOptions(batchList);
     return;
   };
   
   google.script.run.withSuccessHandler(fillBatchOptions).getBatchList();
}
  
  
  



//// Fill options list for batch select element
//function fillBatchOptions(optionsArray){
//  var batchOptions;
//  
//  // If the array is an object, it is coming from the server
//  // Otherwise, it's a string with html options
//  if(typeof optionsArray !== 'object') 
//    batchOptions = convertOptionsArray(optionsArray,memory_.activePage);
//   else 
//    batchOptions = optionsArray;
//  
//  // Append options to batch select element
//  fillHtmlSelect('#batchSelector',batchOptions);
//  
//  
//  // Show selector and get data from server if there is already a batch id selected
//  loadBatch();
//  
//  // Hide pre-loader
//  $("#indexLoader").hide();
//  
//  // Store batchOptions as a temporary variable
//  memory_.lists.batchOptions = batchOptions;
//}
//
//
//
//
//
//
//  
//// Load batch selector element
//// If necessary, load batch data for page
//function loadBatch(){
//
//  var batchId = setBatchSelectOption();
//
//    if (!batchId) return;
//    getBatchData(batchId);
//    
//    return;
//  
//  
//}
//
//
//
//
///**
//* Gets the current batch id from the temporary storage object
//* and sets it as the selected option in the batch select element
//*
//* If there is no current batch id, returns undefined.
//*
//* returns {string} batch id
//*/
//function setBatchSelectOption(){
//   // Check if a batch id has already been used
//    // This will allow the user to navigate back and forth through pages 
//    // without having to re-select the batch
//    var batchId = getBatchId();
//   
//   
//    if (!batchId) {
//      return;
//    }
//  
//    // the batch id is also the elements id
//    var selectItem = $("option[data-id='" + batchId +"']");
//    
//    // Get index of batch id in batch select
//    var index = $("option").index(selectItem);
//    
//    // Get value of the option by it's index
//    var selectedValue = $("#batchSelector").children().eq(index).val();
//    
//    // Set value in select element
//    // Utilizes the bootstrap-select library to set the selected value
//    $('#batchSelector').selectpicker('val', selectedValue);
//    
//    return batchId;
//}