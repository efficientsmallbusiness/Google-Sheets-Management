<script>
/**
* global_js_tables
*
* The functions and event handlers in this file handle global actions
* for the bootstap tables.
*
* If a function is not globally relevant, it can be found in it's respective file
*/



  /** 
  * Table click events
  * This is used to trigger events when a table is clicked on
  * Currenty, it handles edit/delete/confirm/cancel actions
  * but it could be set to handle different things
  */
  // This must exist if the table buttons exist
  window.operateEvents = {
    // Table item with "open" class was clicked
    'click .open': function (e, value, row, index) {
       tableOpenClick(this, e, value, row, index);
    },
    // Table item with "edit" class was clicked
    'click .edit': function (e, value, row, index) {
       tableEditClick(this, e, value, row, index);
    },
     // Table item with a "saveIcon" class was clicked
    'click .confirmSave': function (e, value, row, index) {
        tableConfirmSaveClick(this, e, value, row, index);
    },
    // Table item with a "remove" class was clicked
    'click .remove': function (e, value, row, index) {
      tableRemoveClick(this, e, value, row, index);
    },
    // Table item with a "confirmDelete" class was clicked
    'click .confirmDelete': function (e, value, row, index) {
        tableConfirmDeleteClick(this, e, value, row, index);
    },
    // Table item with a "cancelDelete" class was clicked
    'click .cancelDelete': function (e, value, row, index) {
       tableCancelDeleteClick(this, e, value, row, index);
    },
    // Table item with a "view" class was clicked
    'click .view': function (e, value, row, index) {
       tableViewClick(this, e, value, row, index);
    }
    
  }
  
  
  
  
  
  /**
  * Reset table view when a tab is shown
  *
  * When a table is loaded while hidden (in this instance within a tab), 
  * the height element doesn't load properly
  * so it needs to be reset when the appropriate tab is selected
  * This event trigger resets the table height every time a tab is selected
  * 
  */
  $(document).on('shown.bs.tab', 'a[data-toggle="tab"]', function(event){
 
    // Get div that is associated with the selected(this) tab
    var tabId = $(this).attr('aria-controls');
    
    // Get all tables within div
    $('#'+tabId+' table').each(function(){ 
      // Reset table height of each table in the active tab
      // The height should match the height set in the HTML table element
      $(this).bootstrapTable( 'resetView' , {height: 200} );
    });
  });


  
  /**
 * Creates a dblClick event for a bootstrap table
 */
 function createDblClickEvent() {
   $('.listTableDblClk').off('dbl-click-row.bs.table').on('dbl-click-row.bs.table', function (e, row, $element) {
         const id = row.id;
         getPage( pageToLoad(id) ,id);
      });
 }
  
  
  /**
  * "newRow" button click. A
  */
  function createNewRowEventTrigger(){
      // Because this event trigger is created when a new file is loaded
      // It is most likely creating multiple event triggers
      // So I included ".off('click')" to remove any triggers that may exist
      $(".newRow").off('click').click(function(e){
       
       newTableRowEvent(e);
        
     });
 }
  
  
  
  

  /**
  * Is triggered on "newRow" button click event
  *
  *
  * The button click events must remain with their respective files (instead of here)
  * Because the event handler needs to be created after the DOM element
  * otherwise it doesn't work. (this doesn't seem to be true of the Bootstrap tables
  *
  * @param el {DOM Element} Button
  *
  * return {callback function} calls server-side function "getRowId" and returns response to client-side function "newTableRow"
  */
  function newTableRowEvent(el) {
       var btnId = el.target.id;
       
       var index = btnId.indexOf('-');
      // The table name that the button is attached to
      var btnTable = btnId.substring(index+1,btnId.length);
      
      var saveBtn = el.target;
      var loadBtn = "#"+btnId+"-loading";
      
      $(saveBtn).hide();
      $(loadBtn).show();
      
      var output = {};
      
      // Determine which button was clicked
      // Then get the button's id
      // If it's an ingredient/additive table
      // Get what type of item it is
      switch(btnTable) {
        case 'ingrBtn':
          output.tableId = '#'+TABLES.ingredient.id;
          output.type = 'ingredient';
          break;
        case 'addtvBtn':
          output.tableId = '#'+TABLES.additive.id;
          output.type = 'additive';
          break;
        case 'lossBtn':
          output.tableId = '#'+TABLES.loss.id;
          break;
        case 'fermentBtn':
          output.tableId = '#'+TABLES.ferment.id;
          break;
        case 'blendBtn':
          output.tableId = '#'+TABLES.blend.id;
          break;
        default:
          break;
      }
      
      // Add button id to output, so the loading button can be hidden and the regular can be shown from the callback function
      output.btnId = btnId;
      
      // Get the current id of whatever file is active. batch, recipe, etc...
      // and add it to the output object
      output[CURRENT_PAGE+'Id'] = getSelectedRecord();

      // Check if ui lists have been loaded. If not, get them from the server
      // The inventory/ingredient list is in the ui lists, so if it's not here, none of them are
      uiListExists('ingredient');
          
      // If there isn't a batch loaded, alert user
      if (!output[CURRENT_PAGE+'Id']) {
        // There should always be a batch
        alert('You must select or create a new recipe');
        return;
      };
  
      // Get the next available id from the server.
      // The output object is passed through, so it can be used in the newTableRow function
      google.script.run.withSuccessHandler(newTableRow).getRowId(JSON.stringify(output));
  }
  
  
  
  
  // Check if ui lists have been loaded. If not, get them from the server
  function uiListExists(listName){
    if (memory_.lists[listName]) return;
    google.script.run.withSuccessHandler(separateUiListsAndConvertToHtml).getPageData(memory_.user.company,"UI_LISTS");
  }
 
  
  
  
  
  /**
  * Add a new row to a table
  * This functioned is a callback function for "newTableRowEvent"
  * @param responseObject {object} Stringified JSON object passed from server-side
  * @return none
  */
  function newTableRow(responseObject){
    var obj = JSON.parse(responseObject);
    
    var fileName = CURRENT_PAGE;
    
    // The object to be put back into the table
    // The object will be filled with values below
    var initialRowValues = {};
    
    // Check if the object contains an ingredient table
    if (obj.tableId === '#'+TABLES.ingredient.id || obj.tableId === '#'+TABLES.additive.id) {
        // Because the ingredient and additive data live in the same table, they have a parameter that denotes what type they are
        initialRowValues.type = obj.type
        // Record creation date. The other tables have a date field that can be edited. And we don't need to know exactly when they created the record for those things
        initialRowValues.created = new Date(); 
    }
  
    // These are mandatory fields for every table record
    initialRowValues[fileName+'Id'] = getSelectedRecord(); // Selected batch or recipe id
    initialRowValues.id = obj.id; // Generated record number
    initialRowValues.isNew = true; // Let the server know this is a new row, so it will append a row instead of searching for existing record

    
    /**
    * This commented script gets the last row in the table, so a new row is inserted at the bottom
    * I kept it here in case I wanted to change where new rows were added. And I'm not going to remember how to do this
    *    // Get total number of rows
    *    var rowId = $(obj.tableId + " >tbody >tr").length;
    *    // Add 1 to the total rows, so the new row is put on the bottom of the table
    *    rowId = rowId + 1;
    */
    
    // Row id needs to be 0 to insert a new row at the top of the table
    rowId = 0;
    // Get the table object by id
    // The id is stored in the object variable
    var table = $(obj.tableId);
    
    // Insert new row into table
    table.bootstrapTable('insertRow',{
      index: rowId,
      row: initialRowValues //initialRowValues is an array of JSON objects. This can be used to prefill row data
    });
    
    // Set table view to top
    table.bootstrapTable('scrollTo', 'top');
    // Get the element of the clicked button
    var btnId = obj.btnId;
    
    // Hide the loading element and show the regular button element
    $("#"+btnId).show();
    $("#"+btnId+"-loading").hide();
  }  
  
  

  /**
  * Create table icons
  * This is a bootstrap-table operation that automatically fills the specified table columns with the returned data
  */
   function operateFormatter(value, row, index) {
    return [
      '<div class="buttonDiv">',
        '<a class="edit normalIcon" href="javascript:void(0)" title="Edit"><i class="fa fa-pencil"></i></a>',
        '<a class="remove normalIcon" href="javascript:void(0)" title="Delete"><i class="fa fa-trash text-secondary" style="margin-left:25px;"></i></a>',
        '<a class="confirmSave saveIcon" href="javascript:void(0)" title="Save"><i class="fa fa-check text-success"></i></a>',
        '<a class="confirmDelete deletingIcon" href="javascript:void(0)" title="Confirm delete" ><i class="fa fa-check text-success"></i></a>',
        '<a class="cancelDelete deletingIcon" href="javascript:void(0)" title="Cancel delete" ><i class="fa fa-ban text-danger" style="margin-left:25px;"></i></a>',
      '</div>'
    ].join('')
  }
  
  
  
  
  /**
  * Create table icons with a "list" icon instead of "pencil" icon
  * This denotes that the table details will open in a modal dialog
  * (whereas the pencil icon denotes that a table can be edited in-place)
  */
  function operateEditFormatter(value, row, index) {
    return [
      '<div class="buttonDiv">',
        '<a href="#" class="view text-primary normalIcon" title="View details"><i class="fa fa-list"></i></a>',
        '<a class="remove normalIcon" href="javascript:void(0)" title="Delete"><i class="fa fa-trash text-secondary" style="margin-left:25px;"></i></a>',
        '<a class="confirmDelete deletingIcon" href="javascript:void(0)" title="Confirm delete" ><i class="fa fa-check text-success"></i></a>',
        '<a class="cancelDelete deletingIcon" href="javascript:void(0)" title="Cancel delete" ><i class="fa fa-ban text-danger" style="margin-left:25px;"></i></a>',
      '</div>'
    ].join('')
  }
  
  
  function listTableButtons(value, row, index) {
    return [
      '<div class="buttonDiv">',
        '<a href="#" class="open text-primary normalIcon" title="Open">View</a>',
       '</div>'
    ].join('')
  }
  
  
  /**
  * Reformats the entered date within a table
  * @return {date} formatted date value
  */
  function dateFormatter(value) {
    var dt = new Date(value);
    return value ? dt.getMonth( ) +'/'+ dt.getDate( ) + '/' +dt.getFullYear( ) : '';
  }
  


  /**
  * Insert current cell value into options list then insert select html into table cell
  */
  function addSelectToCell(tableCell,cellValue,listName){
  
    var list = '';
    var htmlSelect = '';
    
    // Get the appropriate list from the tableData object 
    list = memory_.lists[listName];
    
    // Inser the HTML string into the select statement
   // htmlSelect = '<select class="form-control"><option selected>'+ cellValue +'</option>' + list + '</select>';
    htmlSelect = '<input list="invent" autocomplete="off" class="dataList"><datalist id="invent"><option selected>'+ cellValue +'</option>' + list + '</datalist>';
  
    // Insert html into table cell
    tableCell.html(htmlSelect);
  }
  
  
  
  
  /**
  * Put a number input into table cell
  */
  function addNumberInput(tableCell,cellValue){
     var numberInput = '<input type="number" step="0.001" min="0">';
     tableCell.html(numberInput).val(cellValue);
     // Get new input element
     var inputElem = tableCell.children('input');
     // Insert current cell value into input field
     inputElem.val(cellValue);
  }


  /**
  * Put a text input into table cell
  */
  function addTextInput(tableCell,cellValue){
     var numberInput = '<input type="text">';
     tableCell.html(numberInput).val(cellValue);
     // Get new input element
     var inputElem = tableCell.children('input');
     // Insert current cell value into input field
     inputElem.val(cellValue);
  }


  /**
  * Put a date input into table cell
  */
  function addDateInput(tableCell,cellValue){
     var numberInput = '<input type="date">';
     tableCell.html(numberInput).val(cellValue);
     // Get new input element
     var inputElem = tableCell.children('input');
     // Insert current cell value into input field
     inputElem.val(cellValue);
  }
  
  
  
  /*
  * @param tableId {string} Current table id
  * @param id {string} The table id
  * @param page {string} The page type is at the beginning of the id name "recipe-ingredientTable"
  *
  * Return {string} the spreadsheet tab name that matches the UI table name
  */
  function getDatabaseTableName(tableId,id,page){
      
      if (id === TABLES.ingredient.id || tableId === TABLES.additive.id) {
          // If the page is "recipeDetail", then give a different table name
          if (page === 'recipe') return 'table_RECIPE_DETAILS';
          return 'table_INGREDIENT_USAGE';
      }
      else if (id === TABLES.loss.id)
          return 'table_LOSS_LOG';
        
      else if (id === TABLES.ferment.id)
           return 'table_FERMENT_LOG';
           
      else if (id === TABLES.blend.id)
           return 'table_TRANSFER_LOG';
  }  
    
  
  
  
  // Create onChange trigger to change unit of measure based on the table drop-down selection
  // Get uom on select change and insert it into the correct column
  function changeUom(tableElement){
    // Get header column elements
    var colElems = tableElement[0].$el[0].rows[0].children;
    
    // Select on change trigger
    $("select").change(function(e){
      var t = $(this);
      var row = t.parent().parent();
      var rowCells = row.children();
      var uom = t.children('option:selected').attr('data-uom');
      
      if (!uom) return;
      
      $.each(colElems,function(ind,el){
        // Get object key / data-field
        var key = $(el).attr('data-field');
        // If the column data-field is "uom"
        if (key === 'uom') {
          // Get the row cell with the matching index of the uom column
          var cell = rowCells[ind];
          // Insert uom from the selected drop-down menu
          $(cell).text(uom);
          
        };
      });
      
    });
    
    
    // datalist on change trigger
    $(".dataList").on('input',function(e){
      var t = $(this);
      
      console.log(t.children('option'));
      var row = t.parent().parent();
      var rowCells = row.children();
      var uom = t.attr('data-uom');
      
      console.log(uom);
      
      if (!uom) return;
      
      $.each(colElems,function(ind,el){
        // Get object key / data-field
        var key = $(el).attr('data-field');
       
        // If the column data-field is "uom"
        if (key === 'uom') {
          // Get the row cell with the matching index of the uom column
          var cell = rowCells[ind];
          
          // Insert uom from the selected drop-down menu
          $(cell).text(uom);
          
        };
      });
    });
  }
  
  
  
  function tableOpenClick(th, e, value, row, index) {
    var table = $(th)[0].$el;
    var rowElem = table[0].rows[index+1];// Add 1 to the index to get the current row, because the header is index 0
    var colElems = table[0].rows[0].children;// Header row columns
    var id;
    
    $.each($(rowElem).children(),function (i) {
      const cellValue = $(this).text();
      const headerTitle = colElems[i].childNodes[0].textContent; // Gets the header value
       if (headerTitle == 'ID') {
         id = cellValue;
      }
     });
    
    getPage( pageToLoad(id) ,id);
  }
  
  
 
  
  
  /**
  * This function handles the tasks when the edit icon is selected on a table
  */
  function tableEditClick(th, e, value, row, index) {
        var ths = $(th);
        var table = ths[0].$el;
        // Add 1 to the index to get the current row, because the header is index 0
        var rowElem = table[0].rows[index+1];
        // Header row columns
        var colElems = table[0].rows[0].children;
        // Div containing the edit/delete icons
        var iconDiv = $(e.target).parent().parent();
        
        // Center icon, so the save icon is in the middle
        iconDiv.css( "text-align", "center" )
        // Show save icon
        iconDiv.children(".saveIcon").show();
        // Hide normal icons
        iconDiv.children(".normalIcon").hide();
      
        // Get all td (row cells) elements of tr (table row)
        var cells = $(rowElem).find('td');
        // Loop through row columns and make them editable
        cells.each (function(ind,cell) {
            
            // this
            var t = $(this);
            // Current cell value
            var cellValue = t.text();
            // Get the list of classes from the th element being looped over
            var classes = colElems[ind].classList;
            // Determine if cell needs an element inserted
            
            // Check if current column index is editable
            if (!classes.contains('noEdit')) {
            
              // Check if an ingredient select box needs added
              if (classes.contains('ingredientSelect')){
                  // Create select element and insert cell value as selected item
                  addSelectToCell(t,cellValue,'inventory');
                  // Change the UoM of the adjacent cell
                  changeUom(ths);
              }
              // Check if a loss select box needs added
              else if (classes.contains('lossSelect')){
                  // Create select element and insert cell value as selected item
                  addSelectToCell(t,cellValue,'loss');
              }
              // Check if a batch select box needs added
              else if (classes.contains('batchSelect')){
                  // Create select element and insert cell value as selected item
                  addSelectToCell(t,cellValue,'batch');
              }
              // Check if a number input element needs added
              else if (classes.contains('numberInput')){
                addNumberInput(t,cellValue);
              }
              // Check if a text input element needs added
              else if (classes.contains('textInput')){
                addTextInput(t,cellValue);
              }
              // Check if a date input element needs added
              else if (classes.contains('dateInput')){
                addDateInput(t,cellValue);
              }
             
              // This function made the table row editable
              // This is no longer used because input fields are created
              // over the top of the cell, so the cell does not need to be editable
             // makeRowEditable(t);
            };
        });  
   }
   
   
   
   
   
   /**
  * This funcation handles the tasks when the confirmSave icon is selected on a table
  */
   function tableConfirmSaveClick(th, e, value, row, index) {
       // this could be useful for updating individual table rows
       // https://examples.bootstrap-table.com/index.html#methods/update-by-unique-id.html
        //or this
        // $table.bootstrapTable('updateCellByUniqueId', {id: 3, field: 'name', value: 'Updated Name'}).
        
        
        // this
        var ths = $(th);
        // Add 1 to the index to get the current row, because the header is index 0
        var rowElem = ths[0].$el[0].rows[index+1];
        
        // Div containing the icons
        var iconDiv = $(e.target).parent().parent();
        // Left align the icons, so they fit in the cell
        iconDiv.css( "text-align", "left");
        
        // Hide save icon
        $(e.target).parent().parent().children(".saveIcon").hide();
        // Show normal icons
        var normalIcons = $(e.target).parent().parent().children(".normalIcon").show();
        // Header row columns
        var colElems = ths[0].$el[0].rows[0].children;
        // Get all td elements of tr
        var cells = $(rowElem).find('td');
        
        // Loop through row columns and make them not editable
        cells.each (function(ind,cell) {
        
            // Get the list of classes from the th element being looped over
            var classes = colElems[ind].classList;
            
            // Get the data-field from the colum header
            // this value is used as the key in the row object
            // There is probably a way to do this in Jquery, but I couldn't figure it out
            var rowKey = colElems[ind].getAttribute('data-field').toString();
          
            updateTableCell($(this),classes);
         
            // Update the row object using the row key and the text content of the current cell
            // This is the JSON object that will be sent back to the server
            // This must happen after the HTML element is converted to text
            // Otherwise it won't find a value
            row[rowKey] = rowElem.children[ind].textContent
        });
        
        // Determine the database table name for the specific row
        var tableId = ths[0].$el[0].id;
        var id = tableId.toString();
        var page = tableId.toString().substring(0,tableId.indexOf('-'));
        var databaseTable = getDatabaseTableName(tableId,id,page);
        
        
        // recordId or batchId, etc...
        var recordKey = CURRENT_PAGE+'Id';
        
        
        // Add table name to row object
        row.dbName = databaseTable;
        // Denote if this row should be updated
        row.isUpdate = true;
        // Add the table row index and table id, so the "isNew" value can be removed after the row is saved to the server
        row.tableIndex = index;
        row.tableId = tableId;
        
        
        /**
        * don't do anything if any of the following are true
        *
        * No qty, qty less than 0, no record id, no tableName
        */
        var rowQty = parseFloat(row.qty);
        
        if (rowQty >= 0 && 
            rowQty !== '' && 
            row.dbName && 
            row[recordKey]) {
          // Send row data to server to be updated/saved
          
          console.log('saving table row');
          console.log(JSON.stringify(row));
          google.script.run.withFailureHandler(rowSavingError).withSuccessHandler(removeIsNew).processRow(JSON.stringify(row));
        }
     }
  
  
  
    
  
  
      /**
      * This funcation handles the tasks when the remove icon is selected on a table
      */
      function tableRemoveClick(th, e, value, row, index) {
        // this
        var ths = $(th);
        // Add 1 to the index to get the current row, because the header is index 0
        var rowElem = ths[0].$el[0].rows[index+1];
        var iconDiv = $(e.target).parent().parent()
        
        // Show confirm/cancel delete icons
        iconDiv.children(".deletingIcon").show();
        // Hide edit/Delete icons
        iconDiv.children(".normalIcon").hide();
      }
  
  
      /**
      * This funcation handles the tasks when the confirmDelete icon is selected on a table
      */
      function tableConfirmDeleteClick(th, e, value, row, index){
     
       // this
       var ths = $(th);
        var iconDiv = $(e.target).parent().parent();
        // Hide confirm/cancel delete icons
         iconDiv.children(".deletingIcon").hide();
        // Show edit/delete icons
        iconDiv.children(".normalIcon").show();
        var thisTable = ths[0].$el;
      
        // Determine the database table name for the specific row
        var tableId = thisTable[0].id;
        var id = tableId.toString();
        var page = tableId.toString().substring(0,tableId.indexOf('-'));
        var recordId = page + 'Id';
        var databaseTable = getDatabaseTableName(tableId,id,page);
        
        // Add table name to row object
        row.dbName = databaseTable;
        // Denote if this item should be deleted
        row.isDelete = true;
        row.tableId = tableId;
        // Remove table row
        thisTable.bootstrapTable('remove', {
          field: 'id',
          values: [row.id]
        })
        
        console.log('delete confirmed');
        console.log('Check for row id, batch id, and table name');
        console.log(JSON.stringify(row));
        
        // Send row data to server to be deleted
          google.script.run.withFailureHandler(rowSavingError).withSuccessHandler().processRow(JSON.stringify(row));
      }



      /**
      * This funcation handles the tasks when the cancelDelete icon is selected on a table
      */
      function tableCancelDeleteClick(th, e, value, row, index) {
         // this
         var ths = $(th);
         var iconDiv = $(e.target).parent().parent();
         // Add 1 to the index to get the current row, because the header is index 0
        var rowElem = ths[0].$el[0].rows[index+1];
        
        $(rowElem).removeAttr("style");
         // Hide confirm/cancel delete icons
        iconDiv.children(".deletingIcon").hide();
        // Show edit/delete icons
        iconDiv.children(".normalIcon").show();
      }


    /**
    * This funcation handles the tasks when the view icon is selected on a table
    */
    function tableViewClick(ths, e, value, row, index) {
       // Clear fillable modal elements
       $('[data-ferment-modal-id]').val(''); 
       
       // Loop through the modal input elements
       $('[data-ferment-modal-id]').each(function () {
            var modalElem = $(this);
            var modalId = modalElem.attr('data-ferment-modal-id');
            
            // Loop over the table row values
            for (var key in row) {
               // If the row object key equals the modal's data attribute, insert the value into the input element
               if (modalId.toString() === key.toString())
                   if (modalElem.is( "h5" )){
                   modalElem.text(row[key]);
                   } else {
                     modalElem.val(row[key]);
                   }
             }
            
        });
       
       
       /** 
       * Open the modal dialog
       * The modal can also be opened using html data attributes instead of JS
       * EXAMPLE: '<a href="#" data-toggle="modal" data-target="#detailsModal">Open</a>' OR '<button data-backdrop="static" data-keyboard="false" data-toggle="modal" data-target="#detailsModal">Open</button>'
       *
       * The backdrop and keyboard attributes being passed
       * prevent the modals default behaviour of closing when the background is clicked or ESC is pressed
       */
       $('#detailsModal').modal({backdrop: 'static', keyboard: false})  
       
    }
    
    
    
    
    
    /**
    * Determine element tag is used then get the value and update the table cell
    *
    * @param td {DOM element} 'td' element within a table
    * @param classes {DOM element array} JQUERY classlist
    */
     function updateTableCell(td,classes){
            var textValue = '';
            
            var tableCellElem = td.children();
            
            if (tableCellElem.is('select')){
               textValue = tableCellElem.children('option:selected').val();
               // This implicitly removes the HTML element by replacing it with text
               td.html(textValue);
            }
            else if (tableCellElem.is('datalist')) {
              textValue = tableCellElem.val();
              console.log(textValue);
              td.html(textValue);
            }
            else if (tableCellElem.is('input')){
              // Get input element's value
              textValue = tableCellElem.val();
              // This implicitly removes the HTML element by replacing it with text
              td.html(textValue);
            }
            
            return;
       }
    
    
    
    
    
    
    
    
    /**
    * removeIsNew
    *
    * Updates row values after removing the "isNew" object. I wasn't able to find another method for doing this
    * so this gets all of the row values, deletes the "isNew" key, then updates the table row
    *
    * @param json {object} JSON object that is passed as a callback response from "tableConfirmSaveClick"
    */
    function removeIsNew(json){
       var rowObj = JSON.parse(json);
       // If the isNew variable persists. any other updates to this row (before the page is reloaded) will append a new row instead of updating the already saved row
       var table = $('#'+rowObj.tableId);
       
       table.bootstrapTable('updateRow', {
            index: rowObj.tableIndex,
            row: rowObj,
        })
        
    }
    

  // Alert user that a save attempt failed when updating a table
  function rowSavingError(){
    customAlert_('error','An attempt to save to the record failed. Refresh the page and try again.');
  }
   
</script>